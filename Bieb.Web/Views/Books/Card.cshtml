@using Bieb.Domain.Entities
@model Bieb.Domain.Entities.Book

<div class="card">
    @if (User.Identity.IsAuthenticated)
    {
        <span class="edit-link">@Html.ActionLink(BiebResources.SharedStrings.Edit, "Edit", new {Model.Id})</span>
    }

    <h1>@Html.DisplayFor(model => model.Title)</h1>
    
    @if (Model.Subtitle != null)
    { 
        <h2>@Html.DisplayFor(model => model.Subtitle)</h2>
    }

    <ul class="info-points">
        @if (Model.Publisher != null || Model.Year != null || Model.Language != null)
        {
            <li>
                @BiebResources.BookStrings.Published: 
                @if (Model.Year != null)
                {
                    <span>@Model.Year,</span>
                }
                @if (Model.Publisher != null)
                {
                    <span>@Html.ActionLink(Model.Publisher.Name, "Details", new { id = Model.Publisher.Id, controller = "Publishers"}),</span>
                }
                @if (@Model.Language != null)
                {
                    <span>in @Model.Language</span>
                }
            </li>
        }
            
        @if (Model.Isbn != null)
        { 
            <li>@BiebResources.SharedStrings.Isbn: @Html.DisplayFor(model => model.Isbn)</li>
        }

        @if (Model.Tags.Any())
        { 
            <li>@BiebResources.SharedStrings.Tags: @string.Join(", ", Model.Tags)</li>
        }

        @if (Model.Series != null)
        {
            <li>@BiebResources.SharedStrings.Series: @Html.ActionLink(Model.Series.Title, "Details", new { id = Model.Series.Id, controller = "series" })</li>
        }
        
        @if (Model.Editors.Any())
        {
            <li>
                <h6>@BiebResources.SharedStrings.Editors</h6>
                <ul>
                    @foreach (var person in Model.Editors)
                    {
                        <li>
                            @Html.ActionLink(person.FullName, "Details", new { id = person.Id, controller = "People" })
                        </li>
                    }
                </ul>
            </li>
        }

        @if (Model.Authors.Any())
        {
            <li>
                <h6>@BiebResources.SharedStrings.Authors</h6>
                <ul>
                    @foreach (var person in Model.Authors)
                    {
                        <li>
                            @Html.ActionLink(person.FullName, "Details", new { id = person.Id, controller = "People" })
                        </li>
                    }
                </ul>
            </li>
        }

        @if (Model.Translators.Any())
        {
            <li>
                <h6>@BiebResources.SharedStrings.Translators</h6>
                <ul>
                    @foreach (var person in Model.Translators)
                    {
                        <li>
                            @Html.ActionLink(person.FullName, "Details", new { id = person.Id, controller = "People" })
                        </li>
                    }
                </ul>
            </li>
        }
    </ul>
    
    @*Hmm, not very clean View - should move this to the model and/or controller*@
    @if (Model is LibraryBook)
    {
        var libraryBook = Model as LibraryBook;
        if (libraryBook.ReferenceBook != null)
         {
             <h2>@BiebResources.SharedStrings.Original:</h2>
             <ul>
                 @if (libraryBook.ReferenceBook.Title != null)
                 {
                     <li>@BiebResources.SharedStrings.Title: @libraryBook.ReferenceBook.Title</li>
                 }
                 @if (libraryBook.ReferenceBook.Subtitle != null)
                 {
                     <li>@BiebResources.SharedStrings.Subtitle: @libraryBook.ReferenceBook.Subtitle</li>
                 }
                 @if (libraryBook.ReferenceBook.Isbn != null)
                 {
                     <li>@BiebResources.SharedStrings.Isbn: @libraryBook.ReferenceBook.Isbn</li>
                 }
                 @if (libraryBook.ReferenceBook.IsbnLanguage.HasValue)
                 {
                     <li>@BiebResources.SharedStrings.Language: @libraryBook.ReferenceBook.Language</li>
                 }
                 @if (libraryBook.ReferenceBook.Year.HasValue)
                 {
                     <li>@BiebResources.SharedStrings.Published: @libraryBook.ReferenceBook.Year</li>
                 }
                 @if (libraryBook.ReferenceBook.Publisher != null)
                 {
                     <li>@BiebResources.SharedStrings.Publisher: @Html.ActionLink(libraryBook.ReferenceBook.Publisher.Name, "Details", new {id = libraryBook.ReferenceBook.Publisher.Id, controller = "Publishers"})</li>
                 }
             </ul>
         }
    }

</div>